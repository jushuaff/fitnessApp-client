{"ast":null,"code":"import{useState,useEffect}from'react';import{BrowserRouter as Router,Route,Routes}from'react-router-dom';import{UserProvider}from'./context/UserContext';import{CartProvider}from'./context/CartContext';import AppNavbar from'./components/AppNavbar';import Container from'react-bootstrap/Container';// Pages\nimport Home from'./pages/Home';import Products from'./pages/Products';import AddProduct from'./pages/AddProduct';import UpdateProduct from'./pages/UpdateProduct';import Login from'./pages/Login';import Logout from'./pages/Logout';import Register from'./pages/Register';import Error from'./pages/Error';import CartView from'./pages/CartView';import OrderView from'./pages/OrderView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[user,setUser]=useState({id:null,isAdmin:false});const unsetUser=()=>{localStorage.clear();setUser({id:null,isAdmin:false});};const token=localStorage.getItem('token');useEffect(()=>{if(token){fetch(\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/users/details\"),{headers:{Authorization:\"Bearer \".concat(token)}}).then(res=>res.json()).then(data=>{if(data.auth!=='Failed'){setUser({id:data._id,isAdmin:data.isAdmin});}else{setUser({id:null,isAdmin:false});}}).catch(error=>{console.error('Error fetching user details:',error);setUser({id:null,isAdmin:false});});}else{setUser({id:null,isAdmin:false});}},[token]);useEffect(()=>{console.log(user);console.log(localStorage);},[user]);return/*#__PURE__*/_jsx(UserProvider,{value:{user,setUser,unsetUser},children:/*#__PURE__*/_jsx(CartProvider,{children:/*#__PURE__*/_jsxs(Router,{children:[/*#__PURE__*/_jsx(AppNavbar,{}),/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/products\",element:/*#__PURE__*/_jsx(Products,{})}),/*#__PURE__*/_jsx(Route,{path:\"/addProduct\",element:/*#__PURE__*/_jsx(AddProduct,{})}),/*#__PURE__*/_jsx(Route,{path:\"/UpdateProduct/:productId\",element:/*#__PURE__*/_jsx(UpdateProduct,{})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(Register,{})}),!token?/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(Login,{})}):null,/*#__PURE__*/_jsx(Route,{path:\"/logout\",element:/*#__PURE__*/_jsx(Logout,{})}),/*#__PURE__*/_jsx(Route,{path:\"/cart\",element:/*#__PURE__*/_jsx(CartView,{})}),/*#__PURE__*/_jsx(Route,{path:\"/orders\",element:/*#__PURE__*/_jsx(OrderView,{})}),\" \",/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Error,{})})]})})]})})});}export default App;","map":{"version":3,"names":["useState","useEffect","BrowserRouter","Router","Route","Routes","UserProvider","CartProvider","AppNavbar","Container","Home","Products","AddProduct","UpdateProduct","Login","Logout","Register","Error","CartView","OrderView","jsx","_jsx","jsxs","_jsxs","App","user","setUser","id","isAdmin","unsetUser","localStorage","clear","token","getItem","fetch","concat","process","env","REACT_APP_API_BASE_URL","headers","Authorization","then","res","json","data","auth","_id","catch","error","console","log","value","children","path","element"],"sources":["D:/ZUITT/B443/b443-csp3-fataek-lim/src/App.js"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { BrowserRouter as Router, Route, Routes } from 'react-router-dom';\nimport { UserProvider } from './context/UserContext';\nimport { CartProvider } from './context/CartContext';\n\nimport AppNavbar from './components/AppNavbar';\nimport Container from 'react-bootstrap/Container';\n\n// Pages\nimport Home from './pages/Home';\nimport Products from './pages/Products';\nimport AddProduct from './pages/AddProduct';\nimport UpdateProduct from './pages/UpdateProduct';\nimport Login from './pages/Login';\nimport Logout from './pages/Logout';\nimport Register from './pages/Register';\nimport Error from './pages/Error';\nimport CartView from './pages/CartView';\nimport OrderView from './pages/OrderView';\n\nfunction App() {\n    const [user, setUser] = useState({\n        id: null,\n        isAdmin: false,\n    });\n\n    const unsetUser = () => {\n        localStorage.clear();\n        setUser({ id: null, isAdmin: false });\n    };\n\n    const token = localStorage.getItem('token');\n\n    useEffect(() => {\n        if (token) {\n            fetch(`${process.env.REACT_APP_API_BASE_URL}/users/details`, {\n                headers: {\n                    Authorization: `Bearer ${token}`,\n                },\n            })\n                .then((res) => res.json())\n                .then((data) => {\n                    if (data.auth !== 'Failed') {\n                        setUser({\n                            id: data._id,\n                            isAdmin: data.isAdmin,\n                        });\n                    } else {\n                        setUser({\n                            id: null,\n                            isAdmin: false, \n                        });\n                    }\n                })\n                .catch((error) => {\n                    console.error('Error fetching user details:', error);\n                    setUser({\n                        id: null,\n                        isAdmin: false,\n                    });\n                });\n        } else {\n            setUser({\n                id: null,\n                isAdmin: false,\n            });\n        }\n    }, [token]);\n\n    useEffect(() => {\n        console.log(user);\n        console.log(localStorage);\n    }, [user]);\n\n    return (\n        <UserProvider value={{ user, setUser, unsetUser }}>\n            <CartProvider>\n                <Router>\n                    <AppNavbar />\n                    <Container>\n                        <Routes>\n                            <Route path=\"/\" element={<Home />} />\n                            <Route path=\"/products\" element={<Products />} />\n                            <Route path=\"/addProduct\" element={<AddProduct />} />\n                            <Route path=\"/UpdateProduct/:productId\" element={<UpdateProduct />} />\n                            <Route path=\"/register\" element={<Register />} />\n                            {!token ? \n                                <Route path=\"/login\" element={<Login />} />\n                            : null}\n                            <Route path=\"/logout\" element={<Logout />} />\n                            <Route path=\"/cart\" element={<CartView />} />\n                            <Route path=\"/orders\" element={<OrderView />} /> {/* Admin and Non-Admin can access their orders */}\n                            <Route path=\"*\" element={<Error />} />\n                        </Routes>\n                    </Container>\n                </Router>\n            </CartProvider>\n        </UserProvider>\n    );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}