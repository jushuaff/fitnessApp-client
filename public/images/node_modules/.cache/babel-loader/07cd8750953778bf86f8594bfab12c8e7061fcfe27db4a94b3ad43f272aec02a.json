{"ast":null,"code":"import React,{useEffect,useState,useContext}from'react';import{Container}from'react-bootstrap';import UserContext from'../context/UserContext';import UserOrderView from'../components/UserOrderView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const OrderView=()=>{const{user}=useContext(UserContext);const[orders,setOrders]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const isAdmin=user.isAdmin;useEffect(()=>{const fetchOrders=async()=>{const url=isAdmin?\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/orders/all-orders\"):\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/orders/my-orders\");const token=localStorage.getItem('token');try{const response=await fetch(url,{headers:{Authorization:\"Bearer \".concat(token)}});// if (!response.ok) {\n//     const errorBody = await response.text();\n//     throw new Error(`Failed to fetch orders. Status: ${response.status}, Body: ${errorBody}`);\n// }\nconst data=await response.json();if(data.orders&&data.orders.length>0){setOrders(data.orders);}else{setOrders([]);}}catch(error){console.error('Error fetching orders:',error);setError(error.message);}finally{setLoading(false);}};fetchOrders();},[isAdmin]);if(loading)return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});if(error)return/*#__PURE__*/_jsxs(\"div\",{children:[\"Error: \",error]});return/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(\"h2\",{children:isAdmin?'All Orders':'My Orders'}),orders.length===0?/*#__PURE__*/_jsx(\"div\",{children:\"You have no pending orders\"}):/*#__PURE__*/_jsx(UserOrderView,{orders:orders})]});};export default OrderView;","map":{"version":3,"names":["React","useEffect","useState","useContext","Container","UserContext","UserOrderView","jsx","_jsx","jsxs","_jsxs","OrderView","user","orders","setOrders","loading","setLoading","error","setError","isAdmin","fetchOrders","url","concat","process","env","REACT_APP_API_BASE_URL","token","localStorage","getItem","response","fetch","headers","Authorization","data","json","length","console","message","children"],"sources":["D:/ZUITT/B443/b443-csp3-fataek-lim/src/pages/OrderView.js"],"sourcesContent":["import React, { useEffect, useState, useContext } from 'react';\nimport { Container } from 'react-bootstrap';\nimport UserContext from '../context/UserContext';\nimport UserOrderView from '../components/UserOrderView';\n\nconst OrderView = () => {\n    const { user } = useContext(UserContext);\n    const [orders, setOrders] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n    const isAdmin = user.isAdmin;\n\n    useEffect(() => {\n        const fetchOrders = async () => {\n            const url = isAdmin ? `${process.env.REACT_APP_API_BASE_URL}/orders/all-orders` : `${process.env.REACT_APP_API_BASE_URL}/orders/my-orders`;\n            const token = localStorage.getItem('token');\n\n            try {\n                const response = await fetch(url, {\n                    headers: {\n                        Authorization: `Bearer ${token}`,\n                    },\n                });\n\n                // if (!response.ok) {\n                //     const errorBody = await response.text();\n                //     throw new Error(`Failed to fetch orders. Status: ${response.status}, Body: ${errorBody}`);\n                // }\n\n                const data = await response.json();\n                if (data.orders && data.orders.length > 0) {\n                    setOrders(data.orders);\n                } else {\n                    setOrders([]);\n                }\n            } catch (error) {\n                console.error('Error fetching orders:', error);\n                setError(error.message);\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        fetchOrders();\n    }, [isAdmin]);\n\n    if (loading) return <div>Loading...</div>;\n\n    if (error) return <div>Error: {error}</div>;\n\n    return (\n        <Container>\n            <h2>{isAdmin ? 'All Orders' : 'My Orders'}</h2>\n            {orders.length === 0 ? (\n                <div>You have no pending orders</div>\n            ) : (\n                <UserOrderView orders={orders} />\n            )}\n        </Container>\n    );\n};\n\nexport default OrderView;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,CAAEC,QAAQ,CAAEC,UAAU,KAAQ,OAAO,CAC9D,OAASC,SAAS,KAAQ,iBAAiB,CAC3C,MAAO,CAAAC,WAAW,KAAM,wBAAwB,CAChD,MAAO,CAAAC,aAAa,KAAM,6BAA6B,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAExD,KAAM,CAAAC,SAAS,CAAGA,CAAA,GAAM,CACpB,KAAM,CAAEC,IAAK,CAAC,CAAGT,UAAU,CAACE,WAAW,CAAC,CACxC,KAAM,CAACQ,MAAM,CAAEC,SAAS,CAAC,CAAGZ,QAAQ,CAAC,EAAE,CAAC,CACxC,KAAM,CAACa,OAAO,CAAEC,UAAU,CAAC,CAAGd,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACe,KAAK,CAAEC,QAAQ,CAAC,CAAGhB,QAAQ,CAAC,IAAI,CAAC,CACxC,KAAM,CAAAiB,OAAO,CAAGP,IAAI,CAACO,OAAO,CAE5BlB,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAmB,WAAW,CAAG,KAAAA,CAAA,GAAY,CAC5B,KAAM,CAAAC,GAAG,CAAGF,OAAO,IAAAG,MAAA,CAAMC,OAAO,CAACC,GAAG,CAACC,sBAAsB,0BAAAH,MAAA,CAA0BC,OAAO,CAACC,GAAG,CAACC,sBAAsB,qBAAmB,CAC1I,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAE3C,GAAI,CACA,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,CAACT,GAAG,CAAE,CAC9BU,OAAO,CAAE,CACLC,aAAa,WAAAV,MAAA,CAAYI,KAAK,CAClC,CACJ,CAAC,CAAC,CAEF;AACA;AACA;AACA;AAEA,KAAM,CAAAO,IAAI,CAAG,KAAM,CAAAJ,QAAQ,CAACK,IAAI,CAAC,CAAC,CAClC,GAAID,IAAI,CAACpB,MAAM,EAAIoB,IAAI,CAACpB,MAAM,CAACsB,MAAM,CAAG,CAAC,CAAE,CACvCrB,SAAS,CAACmB,IAAI,CAACpB,MAAM,CAAC,CAC1B,CAAC,IAAM,CACHC,SAAS,CAAC,EAAE,CAAC,CACjB,CACJ,CAAE,MAAOG,KAAK,CAAE,CACZmB,OAAO,CAACnB,KAAK,CAAC,wBAAwB,CAAEA,KAAK,CAAC,CAC9CC,QAAQ,CAACD,KAAK,CAACoB,OAAO,CAAC,CAC3B,CAAC,OAAS,CACNrB,UAAU,CAAC,KAAK,CAAC,CACrB,CACJ,CAAC,CAEDI,WAAW,CAAC,CAAC,CACjB,CAAC,CAAE,CAACD,OAAO,CAAC,CAAC,CAEb,GAAIJ,OAAO,CAAE,mBAAOP,IAAA,QAAA8B,QAAA,CAAK,YAAU,CAAK,CAAC,CAEzC,GAAIrB,KAAK,CAAE,mBAAOP,KAAA,QAAA4B,QAAA,EAAK,SAAO,CAACrB,KAAK,EAAM,CAAC,CAE3C,mBACIP,KAAA,CAACN,SAAS,EAAAkC,QAAA,eACN9B,IAAA,OAAA8B,QAAA,CAAKnB,OAAO,CAAG,YAAY,CAAG,WAAW,CAAK,CAAC,CAC9CN,MAAM,CAACsB,MAAM,GAAK,CAAC,cAChB3B,IAAA,QAAA8B,QAAA,CAAK,4BAA0B,CAAK,CAAC,cAErC9B,IAAA,CAACF,aAAa,EAACO,MAAM,CAAEA,MAAO,CAAE,CACnC,EACM,CAAC,CAEpB,CAAC,CAED,cAAe,CAAAF,SAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}